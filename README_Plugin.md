# 飞书多维表格截图插件

## 功能介绍

这是一个专为飞书多维表格设计的截图插件，提供类似WPS表格和Windows系统的截图功能，支持：

- **全屏截图**：截取整个屏幕的内容
- **窗口截图**：截取当前活动窗口的内容
- **区域截图**：自由选择屏幕上的任意区域进行截图
- **保存截图**：将截图保存到本地文件
- **复制到剪贴板**：将截图直接复制到系统剪贴板
- **撤销功能**：支持撤销上一步操作
- **飞书集成**：可直接将截图插入到飞书多维表格的单元格中

## 安装方法

### 1. 下载插件

将本项目的所有文件下载到本地目录。

### 2. 在飞书开发者平台创建应用

1. 访问 [飞书开发者平台](https://open.feishu.cn/)
2. 登录并创建一个新的应用
3. 在应用设置中，选择"多维表格插件"类型
4. 配置应用的基本信息和权限

### 3. 上传插件

1. 在飞书开发者平台的应用管理页面，找到"插件管理"
2. 点击"上传插件包"，选择本项目的所有文件（压缩为ZIP格式）
3. 上传完成后，点击"发布"按钮

### 4. 在飞书多维表格中使用

1. 打开飞书多维表格
2. 在表格界面中，点击右上角的"插件"按钮
3. 找到并启用"飞书多维表格截图插件"
4. 插件会在工具栏中添加一个"截图"按钮

## 使用说明

### 截图操作

1. 点击飞书多维表格工具栏中的"截图"按钮，打开截图工具
2. 选择需要的截图类型：
   - 点击"全屏截图"截取整个屏幕
   - 点击"窗口截图"截取当前活动窗口
   - 点击"区域截图"自由选择截图区域
3. 截图完成后，可以：
   - 点击"保存"将截图保存到本地或插入到飞书表格
   - 点击"复制到剪贴板"将截图复制到系统剪贴板
   - 点击"撤销"撤销上一步操作
   - 点击"取消"关闭截图工具

### 在飞书表格中插入截图

1. 首先在飞书多维表格中选择一个目标单元格
2. 打开截图工具并完成截图
3. 点击"保存"按钮，会弹出提示框询问是否插入到表格
4. 点击"确定"，截图将自动插入到选中的单元格中

## 技术说明

### 开发环境

- HTML5 + CSS3 + JavaScript
- 飞书多维表格API
- 浏览器原生截图API (`navigator.mediaDevices.getDisplayMedia`)

### 核心功能实现

1. **截图功能**：使用浏览器的`getDisplayMedia` API实现屏幕捕获
2. **区域选择**：通过Canvas实现自定义区域选择和绘制
3. **飞书集成**：使用飞书多维表格的API (`window.fsTable`) 实现与表格的交互
4. **剪贴板操作**：使用`navigator.clipboard` API实现截图复制

### 权限要求

- `desktopCapture`：屏幕捕获权限
- `tabs`：标签页访问权限
- `activeTab`：当前标签页访问权限
- `clipboardWrite`：剪贴板写入权限
- 飞书多维表格的`table:write`和`table:read`权限

## 测试方法

### 本地测试

1. 直接在浏览器中打开`index.html`文件
2. 测试截图功能是否正常工作
3. 检查保存和复制功能是否正常

### 飞书环境测试

1. 按照安装方法将插件上传到飞书开发者平台
2. 在飞书多维表格中启用插件
3. 测试所有功能是否正常工作
4. 检查截图是否能正确插入到表格单元格中

## 注意事项

1. 本插件需要浏览器支持`navigator.mediaDevices.getDisplayMedia` API
2. 在飞书环境中使用时，需要获取相应的权限
3. 区域截图功能需要鼠标操作，不支持触摸设备
4. 建议使用最新版本的Chrome、Edge或飞书内置浏览器

## 版本更新

- **v1.0.0**：
  - 实现全屏截图、窗口截图和区域截图功能
  - 添加保存、复制和撤销功能
  - 集成飞书多维表格API
  - 优化界面样式

## 联系方式

如有问题或建议，欢迎通过以下方式联系：

- Email: 
- 飞书: 

## 许可证

本项目采用 MIT 许可证。